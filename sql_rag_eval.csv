question_no,user_question,sql_query,tables,columns
1,How many colleagues have completed ART for 'Q3 2024 - ART'?,SELECT COUNT(DISTINCT resource_id) FROM art WHERE final_art_status LIKE 'Completed%' AND compliance_program LIKE '%Q3 2024 - ART%';,,
2,How many colleagues have the course tiltled 'Conduct Rules' ?,SELECT COUNT(*) FROM art WHERE course_name LIKE '%Conduct Rules%';,,
3,How many hours did Jesse Weber 00549109 entered on the 09/06/2024?,SELECT SUM(hours) FROM holiday_details WHERE colleague_id = '00549109' AND entered_on = '2024-06-09';,,
4,"List the names of people in my team (Brian Aguilar'), the hours they have carried forward, and the working hours of those who have carried forward more hours than their weekly working hours?","SELECT full_name, carried_forward, scheduled_working_hours FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE carried_forward > scheduled_working_hours AND direct_line_manager_name = 'Brian Aguilar';",,
5,How many colleagues work Onshore vs Offshore? ,"SELECT COUNT(DISTINCT resource_id), is_onshore FROM people WHERE is_onshore IS NOT NULL GROUP BY is_onshore;",,
6,What is the ART completione rate for London and Bristol for the 'Q3 2024 - ART ' compliance program? Round percentage to 2 decimal points,"SELECT A.City, ROUND(SUM(CASE WHEN B.final_art_status LIKE 'Completed%' THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 2) AS completion_rate_percentage FROM people AS A JOIN art AS B ON A.resource_id = B.resource_id WHERE B.compliance_program LIKE '%Q3 2024 - ART%' AND A.city IN ('Bristol', 'London') GROUP BY A.City;",,
7,How many colleagues work in each job family in my division Sourcing & Vendor Management?,"SELECT COUNT(DISTINCT resource_id), job_family FROM people WHERE division LIKE '%Sourcing & Vendor Management%' GROUP BY job_family;",,
8,I am doing an away day in� October 2024 and� I want all my team to be there. Which days are my colleagues on holiday in October for colleagues managed by Shawn Horn?,"SELECT DISTINCT DATE FROM holiday_details JOIN people ON people.resource_id = holiday_details.colleague_id WHERE DATE BETWEEN '2024-10-01' AND '2024-10-31' AND direct_line_manager_name = 'Shawn Horn' GROUP BY resource_id, DATE HAVING SUM(hours) > 0;",,
9,"How many of each grade are in my team, direct line manager Mary Brooks?","SELECT grade, COUNT(grade) FROM people WHERE direct_line_manager_id = '00000479' GROUP BY grade;",,
10,Im preparing a training session for product owners. Could you tell me which are the top 3 hubs where most of them are stationed? Ignore non hub,"SELECT hub_location, COUNT(*) AS hub_count FROM people WHERE job_title LIKE '%product owner%' AND hub_location <> 'non hub' GROUP BY hub_location ORDER BY hub_count DESC LIMIT 3;",,
11,"Where are my team based and how many are at each hub, my direct line manager id is 00000479 ?","SELECT hub_location, COUNT(*) FROM people WHERE direct_line_manager_id = '00000479' GROUP BY hub_location;",,
12,How many hours has been carried forward in my team (Tim Kent)?,SELECT SUM(carried_forward) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE direct_line_manager_name = 'Tim Kent';,,
13,"There has been a workday upgrade on job families, can I check if anyone whoa has data science or data scientist in their job title and  the job family is not Data Science? Give me their id, job title and job family","SELECT resource_id, job_family, job_title FROM people WHERE job_title LIKE '%Data Scien%' AND job_family <> 'Data Science';",,
14,What is the % people who are agency staff that have completed all of 'Q2 2024 - ART' program?,SELECT COUNT(CASE WHEN final_art_status LIKE 'Completed%' THEN 1 END) * 100.0 / COUNT(*) AS percentage_completed FROM art JOIN people ON art.resource_id = people.resource_id WHERE compliance_program LIKE '%Q2 2024 - ART%' AND agency IS NOT NULL;,,
15,"Can I have the top 3 divisions with the most colleagues in Software Engineering, along with the number of software engineers and their percentage share of the total Software Engineering population?","WITH total_engineers AS (SELECT COUNT(*) AS total_count FROM people WHERE job_family LIKE '%Software Engineering%') SELECT division, COUNT(*) AS software_engineer_count, COUNT(*) * 100.0 / (SELECT total_count FROM total_engineers) AS percentage_share FROM people WHERE job_family LIKE '%Software Engineering%' GROUP BY division ORDER BY software_engineer_count DESC LIMIT 3;",,
16,"Christmas� day needs to be booked off, what percentage of staff working in Chief security office division have done this?",SELECT (SELECT COUNT(DISTINCT people.resource_id) FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE holiday_details.date = '2024-12-25' AND people.division LIKE '%Chief Security Office%') * 100.0 / (SELECT COUNT(*) FROM people WHERE people.division LIKE '%Chief Security Office%') AS percentage_on_christmas;,,
17,How many times is Daniel Juarez listed in layer_2?   ,SELECT COUNT(*) FROM people WHERE layer_2 = 'Daniel Juarez';,,
18,Which employee has the longest tenure? ,SELECT full_name FROM people WHERE original_tenure_start IS NOT NULL ORDER BY original_tenure_start ASC LIMIT 1;,,
19,I need the email address of Nathaniel Harris line manager? ,SELECT line_manager_email FROM people WHERE full_name = 'Nathaniel Harris';,,
20,What is the average full-time equivilant (FTE) across all employees based on 1 being eveyone is full time? ,SELECT AVG(fte) FROM people;,,
21,I want to know how many colleague email address domains are different to their line manager domains? ,SELECT COUNT(*) AS DifferentDomainCount FROM people WHERE SUBSTRING(email FROM POSITION('@' IN email) + 1) != SUBSTRING(line_manager_email FROM POSITION('@' IN line_manager_email) + 1);,,
22,Whats the average time between the the entered holiday date and the actual holiday date for employees grade C? Please round to 2 decimal places.,"SELECT ROUND(AVG(EXTRACT(EPOCH FROM (date - entered_on)) / 86400), 2) AS AVG_DIFF FROM people A JOIN holiday_details B ON A.resource_id = B.colleague_id WHERE grade = 'C';",,
23,Can you provide the job title and grades of the top 5 employees with the highest accured holiday hours? ,"SELECT people.job_title, people.grade FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id ORDER BY holiday_balance.accrued DESC LIMIT 5;",,
24,"On average, how many people are managed by grade F managers?","SELECT AVG(count_manager_ids) FROM (SELECT COUNT(*) AS count_manager_ids, direct_line_manager_id FROM people WHERE direct_line_manager_id IN (SELECT resource_id FROM people WHERE grade = 'F') GROUP BY direct_line_manager_id) AS subquery;",,
25,Can you provide the date Robert Benson's most recent leave? ,SELECT MAX(DATE) FROM people A JOIN holiday_details B ON A.resource_id = B.colleague_id WHERE full_name LIKE '%Robert Benson%' AND taken_tf = 1;,,
26,Name of the colleagues scheduled to work the most hours? ,SELECT full_name FROM people WHERE scheduled_working_hours = (SELECT MAX(scheduled_working_hours) FROM people);,,
27,I'm Philip Young. What is the total amount of holiday not booked by my direct team?,SELECT SUM(unbooked) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE direct_line_manager_name = 'Philip Young';,,
28,I'm Philip Young. What is the total amount of holiday still needed to be booked by my direct team?,SELECT SUM(unbooked) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE direct_line_manager_name = 'Philip Young';,,
29,My file id is 00069268. What is the total amount of holiday not booked by my direct team?,SELECT SUM(unbooked) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE direct_line_manager_id = '00069268';,,
30,"How many senior colleagues are in CDAO (cc_layer_2)? Senior colleagues are grades F, G and X","SELECT COUNT(*) FROM people WHERE cc_layer_2 LIKE '%CDAO%' AND grade IN ('F', 'G', 'X');",,
31,How many F+ colleagues are in CDAO (cc_layer_2)? Exclude MT grade,SELECT COUNT(*) FROM people WHERE cc_layer_2 LIKE '%CDAO%' AND grade >= 'F' AND grade <> 'MT';,,
32,I'm Kimberly Mcclure. How many colleagues by grade have yet to complete ART this quarter (Q3 2024 - ART) in my overall team (layer_5)?,"SELECT grade, COUNT(DISTINCT a.resource_id) FROM art AS a JOIN people AS p ON a.resource_id = p.resource_id WHERE layer_5 = 'Kimberly Mcclure' AND compliance_program = 'Q3 2024 - ART' AND final_art_status IN ('In progress', 'Not started') GROUP BY grade;",,
33,I'm Kimberly Mcclure. How many colleagues by grade have yet to complete Q3 2024 - ART in my team (layer_5)?,"SELECT grade, COUNT(DISTINCT a.resource_id) FROM art AS a JOIN people AS p ON a.resource_id = p.resource_id WHERE layer_5 = 'Kimberly Mcclure' AND compliance_program = 'Q3 2024 - ART' AND final_art_status IN ('In progress', 'Not started') GROUP BY grade;",,
34,I'm Kimberly Mcclure. How many colleagues by grade have yet to complete Q3 2024 - ART in my team (layer_5)? Use DISTINCT id,"SELECT grade, COUNT(DISTINCT a.resource_id) FROM art AS a JOIN people AS p ON a.resource_id = p.resource_id WHERE layer_5 = 'Kimberly Mcclure' AND compliance_program = 'Q3 2024 - ART' AND final_art_status IN ('In progress', 'Not started') GROUP BY grade;",,
35,My file id is 00069268  (layer_6). What is the amount of holiday still to take for each colleague (resource_id) in my team ordered by biggest first,"SELECT resource_id, untaken FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE layer_6_file_id = '00069268' ORDER BY untaken DESC;",,
36,My file id is 00069268  (layer_6_file_id). What is the amount of holiday still to take for each colleague  (resource_id)  in my team ordered by biggest first,"SELECT resource_id, untaken FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE layer_6_file_id = '00069268' ORDER BY untaken DESC;",,
37,My file id is 00069268  (layer_6). What is the amount of holiday not taken for each colleague in my team ordered by biggest first. Give the name and email,"SELECT full_name, email, untaken FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE layer_6_file_id = '00069268' ORDER BY untaken DESC;",,
38,My file id is 00067222. What is the percentage of non perm workers in my direct team?,SELECT (SUM(CASE WHEN high_lev_workertype <> 'Permanent' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) FROM people WHERE direct_line_manager_id = '00067222';,,
39,My file id is 00067222. Can you please tell me the percentage of non permanent workers in my team?,SELECT (SUM(CASE WHEN high_lev_workertype <> 'Permanent' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) FROM people WHERE direct_line_manager_id = '00067222';,,
40,My file id is 00069268  (layer_6_file_id). Who in my team has booked the new year's bank holiday? Want the id and name,"SELECT colleague_id, full_name FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE layer_6_file_id = '00069268' AND DATE = '2024-01-01' GROUP BY colleague_id HAVING SUM(hours) > 1;",,
41,My file id is 00069268  (layer_6_file_id). Who in my team has booked holiday for January first of this year? Want the id and name,"SELECT colleague_id, full_name FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE layer_6_file_id = '00069268' AND DATE = '2024-01-01' GROUP BY colleague_id HAVING SUM(hours) > 1;",,
42,My file id is 00069268  (layer_6_file_id). Who in my team has not booked holiday for January first of this year? Want the id and name,"WITH colleagues_with_booked_date AS (SELECT colleague_id FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE layer_6_file_id = '00069268' AND DATE = '2024-01-01' GROUP BY colleague_id HAVING SUM(hours) > 1) SELECT resource_id, full_name FROM people p LEFT JOIN colleagues_with_booked_date c ON p.resource_id = c.colleague_id WHERE layer_6_file_id = '00069268' AND c.colleague_id IS NULL;",,
43,What colleagues in CDAO (cc_layer_2) have more than 80% of their holidays left unbooked?,SELECT full_name FROM holiday_balance JOIN people ON people.resource_id = holiday_balance.colleague_id WHERE unbooked > 0.8 * entitlement AND cc_layer_2 LIKE '%CDAO%';,,
44,What colleagues in CDAO (cc_layer_2) have more than 80% of holiday entitlement left to book? Give their name,SELECT full_name FROM holiday_balance JOIN people ON people.resource_id = holiday_balance.colleague_id WHERE unbooked > 0.8 * entitlement AND cc_layer_2 LIKE '%CDAO%';,,