Question Number,Category ,Question Source,Datasets,Question Set ,GOLD SQLITE,GOLD POSTGRES,GOLD RESULT,3.2 POSTGRES,3.2 RESULT,SOFT F1,RECALL
1,medium,DAAI - Matt,art ,How many colleagues have completed ART for 'Q3 2024 - ART'?,SELECT COUNT (DISTINCT resource_id) FROM art WHERE final_art_status LIKE 'Completed%' AND compliance_program LIKE '%Q3 2024 - ART%',SELECT COUNT(DISTINCT resource_id) FROM art WHERE final_art_status LIKE 'Completed%' AND compliance_program LIKE '%Q3 2024 - ART%';,[{'count': 10228}],SELECT COUNT(DISTINCT resource_id) FROM art WHERE compliance_program LIKE 'Q3 2024 - ART' AND final_art_status LIKE 'Completed';,[{'count': 10228}],[],
2,easy,DAAI - Matt,art,How many colleagues have the course tiltled 'Conduct Rules' ?,SELECT COUNT (*) FROM art WHERE course_name LIKE '%Conduct Rules%',SELECT COUNT(*) FROM art WHERE course_name LIKE '%Conduct Rules%';,[{'count': 28162}],SELECT COUNT(DISTINCT resource_id) FROM art WHERE (course_name ILIKE '%Conduct Rules%') OR (course_completion_status = 'optional');,[{'count': 28162}],,
3,medium,DAAI - Matt,holiday_details,How many hours did Jesse Weber 00549109 entered on the 09/06/2024?,SELECT SUM(hours) FROM holiday_details WHERE colleague_id = '00549109' and entered_on = '2024-06-09' ,SELECT SUM(hours) FROM holiday_details WHERE colleague_id = '00549109' AND entered_on = '2024-06-09';,[{'sum': 63}],SQL Error 500,,,
4,hard,DAAI - Linda,"people, holiday_balance","List the names of people in my team (Brian Aguilar'), the hours they have carried forward, and the working hours of those who have carried forward more hours than their weekly working hours?","SELECT full_name, carried_forward ,scheduled_working_hours FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE carried_forward > scheduled_working_hours AND direct_line_manager_name = 'Brian Aguilar';","SELECT full_name, carried_forward, scheduled_working_hours FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE carried_forward > scheduled_working_hours AND direct_line_manager_name = 'Brian Aguilar';","[{'full_name': 'Julia Anderson', 'carried_forward': 35.0, 'scheduled_working_hours': 30.0}, {'full_name': 'Mark Holden', 'carried_forward': 35.0, 'scheduled_working_hours': 33.0}, {'full_name': 'Amy Turner', 'carried_forward': 32.0, 'scheduled_working_hours': 21.0}]","SELECT p.full_name, hb.carried_forward, p.scheduled_working_hours FROM people p JOIN holiday_balance hb ON p.resource_id = hb.colleague_id WHERE p.direct_line_manager_name ILIKE '%Brian Aguilar%' AND hb.carried_forward > p.scheduled_working_hours AND p.scheduled_working_hours IS NOT NULL;","[{'full_name': 'Julia Anderson', 'carried_forward': 35.0, 'scheduled_working_hours': 30.0}, {'full_name': 'Mark Holden', 'carried_forward': 35.0, 'scheduled_working_hours': 33.0}, {'full_name': 'Amy Turner', 'carried_forward': 32.0, 'scheduled_working_hours': 21.0}]",,
5,medium,DAAI - Matt,people,How many colleagues work Onshore vs Offshore? ,"SELECT COUNT (DISTINCT resource_id), is_onshore FROM people WHERE is_onshore IS NOT NULL GROUP BY 2 ","SELECT COUNT(DISTINCT resource_id), is_onshore FROM people WHERE is_onshore IS NOT NULL GROUP BY is_onshore;","[{'count': 10593, 'is_onshore': 'Offshore'}, {'count': 20709, 'is_onshore': 'Onshore'}]","SELECT COALESCE(is_onshore, 'Unknown') AS location_status, COUNT(*) FROM people GROUP BY location_status;","[{'count': 10593, 'is_onshore': 'Offshore'}, {'count': 20709, 'is_onshore': 'Onshore'}]",,
6,extra,DAAI - Matt,"people, art",What is the ART completione rate for London and Bristol for the 'Q3 2024 - ART ' compliance program? Round percentage to 2 decimal points,"SELECT A.City ,ROUND(SUM(CASE WHEN B.final_art_status LIKE 'Completed%' THEN 1 ELSE 0 END) * 100.0 / COUNT(*),2) AS completion_rate_percentage FROM people AS A JOIN art AS B ON A.resource_id = B.resource_id WHERE B.compliance_program LIKE '%Q3 2024 - ART%' AND A.city IN ('Bristol', 'London') GROUP BY 1","SELECT A.City, ROUND(SUM(CASE WHEN B.final_art_status LIKE 'Completed%' THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 2) AS completion_rate_percentage FROM people AS A JOIN art AS B ON A.resource_id = B.resource_id WHERE B.compliance_program LIKE '%Q3 2024 - ART%' AND A.city IN ('Bristol', 'London') GROUP BY A.City;","[{'city': 'Bristol', 'completion_rate_percentage': 36.26}, {'city': 'London', 'completion_rate_percentage': 35.91}]",SQL Error 500,,,
7,medium,DAAI - Chloe ,people,How many colleagues work in each job family in my division Sourcing & Vendor Management?,"SELECT COUNT(DISTINCT resource_id),job_family FROM people WHERE division LIKE '%Sourcing & Vendor Management%' GROUP BY job_family","SELECT COUNT(DISTINCT resource_id), job_family FROM people WHERE division LIKE '%Sourcing & Vendor Management%' GROUP BY job_family;","[{'count': 1, 'job_family': 'Analysis & Insight'}, {'count': 2, 'job_family': 'Business Analysis'}, {'count': 5, 'job_family': 'Business Support Functions'}, {'count': 2, 'job_family': 'Communications'}, {'count': 1, 'job_family': 'Data Science'}, {'count': 8, 'job_family': 'Delivery Project Management'}, {'count': 7, 'job_family': 'Executive Support'}, {'count': 6, 'job_family': 'Risk & Control'}, {'count': 314, 'job_family': 'Sourcing'}, {'count': 66, 'job_family': 'Supplier Management'}, {'count': 1, 'job_family': 'Technology'}, {'count': 1, 'job_family': 'Technology Service Support'}]","ELECT COALESCE(job_family, 'Undefined') AS job_family, COUNT(*) AS num_colleagues FROM people WHERE division LIKE 'Sourcing & Vendor Management' GROUP BY job_family;","[{'num_colleagues': 1, 'job_family': 'Analysis & Insight'}, {'num_colleagues': 2, 'job_family': 'Business Analysis'}, {'num_colleagues': 5, 'job_family': 'Business Support Functions'}, {'num_colleagues': 2, 'job_family': 'Communications'}, {'num_colleagues': 1, 'job_family': 'Data Science'}, {'num_colleagues': 8, 'job_family': 'Delivery Project Management'}, {'num_colleagues': 7, 'job_family': 'Executive Support'}, {'num_colleagues': 6, 'job_family': 'Risk & Control'}, {'num_colleagues': 314, 'job_family': 'Sourcing'}, {'num_colleagues': 66, 'job_family': 'Supplier Management'}, {'num_colleagues': 1, 'job_family': 'Technology'}, {'num_colleagues': 1, 'job_family': 'Technology Service Support'}]",,
8,hard,DAAI - Chloe ,"peopl, holiday_details ",I am doing an away day in� October 2024 and� I want all my team to be there. Which days are my colleagues on holiday in October for colleagues managed by Shawn Horn?,"SELECT DISTINCT(DATE) FROM  holiday_details JOIN people ON people.resource_id = holiday_details.colleague_id WHERE date BETWEEN '2024-10-01' AND '2024-10-31' AND direct_line_manager_name = 'Shawn Horn' GROUP BY resource_id, DATE  HAVING SUM(hours) >0;","SELECT DISTINCT DATE FROM holiday_details JOIN people ON people.resource_id = holiday_details.colleague_id WHERE DATE BETWEEN '2024-10-01' AND '2024-10-31' AND direct_line_manager_name = 'Shawn Horn' GROUP BY resource_id, DATE HAVING SUM(hours) > 0;","[{'date': '2024-10-14'}, {'date': '2024-10-15'}, {'date': '2024-10-16'}, {'date': '2024-10-17'}, {'date': '2024-10-18'}, {'date': '2024-10-28'}, {'date': '2024-10-29'}, {'date': '2024-10-30'}, {'date': '2024-10-31'}]",SELECT DISTINCT date FROM holiday_details JOIN people ON people.resource_id = holiday_details.colleague_id WHERE date BETWEEN '2024-10-01' AND '2024-10-31' AND direct_line_manager_name LIKE '%Shawn Horn%' AND hours > 0;,"[{'date': '2024-10-14T00:00:00Z'}, {'date': '2024-10-15T00:00:00Z'}, {'date': '2024-10-16T00:00:00Z'}, {'date': '2024-10-17T00:00:00Z'}, {'date': '2024-10-18T00:00:00Z'}, {'date': '2024-10-28T00:00:00Z'}, {'date': '2024-10-29T00:00:00Z'}, {'date': '2024-10-30T00:00:00Z'}, {'date': '2024-10-31T00:00:00Z'}]",,
9,medium,DAAI - Chloe ,people,"How many of each grade are in my team, direct line manager Mary Brooks?","SELECT grade, COUNT(grade) FROM people WHERE direct_line_manager_id = '00000479' GROUP BY grade","SELECT grade, COUNT(grade) FROM people WHERE direct_line_manager_id = '00000479' GROUP BY grade;","[{'grade': 'C', 'count': 2}, {'grade': 'D', 'count': 7}, {'grade': 'E', 'count': 21}, {'grade': 'F', 'count': 4}, {'grade': 'U', 'count': 2}]","SELECT grade, COUNT(*) FROM people WHERE direct_line_manager_name ILIKE 'Mary Brooks' AND grade IS NOT NULL GROUP BY grade; -- Ideally, use a unique manager identifier (e.g., direct_line_manager_id or line_manager_email) if available","[{'grade': 'C', 'count': 2}, {'grade': 'D', 'count': 7}, {'grade': 'E', 'count': 21}, {'grade': 'F', 'count': 4}, {'grade': 'U', 'count': 2}]",,
10,hard,DAAI - Chloe ,people,I�m preparing a training session for product owners. Could you tell me which are the top 3 hubs where most of them are stationed? Ignore non hub,"SELECT hub_location, COUNT(*) AS hub_count FROM people WHERE job_title LIKE '%product owner%' AND hub_location <> 'non hub' GROUP BY hub_location ORDER BY hub_count DESC LIMIT 3;","SELECT hub_location,
job_title, 
COUNT(*) AS hub_count 
FROM people 
WHERE job_title iLIKE 'product owner' 
AND hub_location <> 'non hub' 
GROUP BY job_title, hub_location 
ORDER BY hub_count Desc limit 3;","[ {'grade': 'London', 'count': 77},
 {'grade': 'Edinburgh', 'count': 53},
 {'grade': 'West Yorkshire', 'count': 47}]",Need to re run as lost SQL,,,
11,medium,DAAI - Chloe ,"people, holiday_details","Where are my team based and how many are at each hub, my direct line manager id is 00000479 ?","SELECT hub_location, COUNT(*) FROM people WHERE direct_line_manager_id = '00000479' GROUP BY hub_location;","SELECT hub_location, COUNT(*) FROM people WHERE direct_line_manager_id = '00000479' GROUP BY hub_location;","[{'hub_location': 'Birmingham', 'count': 1}, {'hub_location': 'Bristol', 'count': 2}, {'hub_location': 'Cardiff', 'count': 1}, {'hub_location': 'Edinburgh', 'count': 5}, {'hub_location': 'Glasgow', 'count': 1}, {'hub_location': 'London', 'count': 7}, {'hub_location': 'non hub', 'count': 14}, {'hub_location': 'West Yorkshire', 'count': 5}]","SELECT DISTINCT hub_location, COUNT(*) FROM people WHERE direct_line_manager_id LIKE '00000479' GROUP BY hub_location;","[{'hub_location': 'Birmingham', 'count': 1}, {'hub_location': 'Bristol', 'count': 2}, {'hub_location': 'Cardiff', 'count': 1}, {'hub_location': 'Edinburgh', 'count': 5}, {'hub_location': 'Glasgow', 'count': 1}, {'hub_location': 'London', 'count': 7}, {'hub_location': 'non hub', 'count': 14}, {'hub_location': 'West Yorkshire', 'count': 5}]",,
12,medium,DAAI - Linda,"people, holiday_balance",How many hours has been carried forward in my team (Tim Kent)?,SELECT SUM(carried_forward) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE direct_line_manager_name = 'Tim Kent';,SELECT SUM(carried_forward) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE direct_line_manager_name = 'Tim Kent';,[{'sum': 387.9}],SELECT SUM(carried_forward) FROM holiday_balance WHERE report_date = (SELECT MAX(report_date) FROM holiday_balance) AND colleague_id IN (SELECT resource_id FROM people WHERE direct_line_manager_name ILIKE '%Tim Kent%');,[{'sum': 387.9}],,
13,medium,DAAI - Linda,"people, holiday_details","There has been a workday upgrade on job families, can I check if anyone whoa has data science or data scientist in their job title and  the job family is not Data Science? Give me their id, job title and job family","SELECT resource_id, job_family, job_title  from people WHERE job_title LIKE '%Data Scien%' AND job_family <> 'Data Science';","SELECT resource_id, job_family, job_title FROM people WHERE job_title LIKE '%Data Scien%' AND job_family <> 'Data Science';","[{'resource_id': '00772388', 'job_family': 'Data & Analytics Strategy', 'job_title': 'Data Science Manager'}]","SELECT resource_id, job_title, job_family FROM people WHERE (LOWER(job_title) LIKE '%data science%' OR LOWER(job_title) LIKE '%data scientist%') AND LOWER(job_family) != 'data science';","[{'resource_id': '00772388', 'job_title': 'Data Science Manager', 'job_family': 'Data & Analytics Strategy',}]",,
14,hard,DAAI - Linda,"people, ART",What is the % people who are agency staff that have completed all of 'Q2 2024 - ART' program?,SELECT COUNT(CASE WHEN final_art_status LIKE 'Completed%' THEN 1 END) * 100.0 / COUNT(*) AS percentage_completed FROM art JOIN people ON art.resource_id = people.resource_id WHERE compliance_program LIKE '%Q2 2024 - ART%' AND agency IS NOT NULL;,SELECT COUNT(CASE WHEN final_art_status LIKE 'Completed%' THEN 1 END) * 100.0 / COUNT(*) AS percentage_completed FROM art JOIN people ON art.resource_id = people.resource_id WHERE compliance_program LIKE '%Q2 2024 - ART%' AND agency IS NOT NULL;,[{'percentage_completed': 94.8721183621975}],SELECT CAST(COUNT(DISTINCT CASE WHEN art.final_art_status ILIKE 'Completed' THEN art.resource_id ELSE NULL END) AS REAL) * 100 / COUNT(DISTINCT p.resource_id) FROM people p JOIN art ON p.resource_id = art.resource_id WHERE p.agency IS NOT NULL AND art.compliance_program ILIKE 'Q2 2024 - ART';,"[{""?column?"": 92.194257}]",,
15,extra,DAAI - Linda,people,"Can I have the top 3 divisions with the most colleagues in Software Engineering, along with the number of software engineers and their percentage share of the total Software Engineering population?","WITH total_engineers AS (SELECT COUNT(*) AS total_count FROM people WHERE job_family LIKE '%Software Engineering%') SELECT division ,COUNT(*) AS software_engineer_count ,COUNT(*) * 100.0 / (SELECT total_count FROM total_engineers) AS percentage_share FROM people WHERE job_family LIKE '%Software Engineering%' GROUP BY division ORDER BY software_engineer_count DESC LIMIT 3;","WITH total_engineers AS (SELECT COUNT(*) AS total_count FROM people WHERE job_family LIKE '%Software Engineering%') SELECT division, COUNT(*) AS software_engineer_count, COUNT(*) * 100.0 / (SELECT total_count FROM total_engineers) AS percentage_share FROM people WHERE job_family LIKE '%Software Engineering%' GROUP BY division ORDER BY software_engineer_count DESC LIMIT 3;","[{'division': 'Retail Platforms', 'software_engineer_count': 2174, 'percentage_share': 27.425255456036332}, {'division': 'Platforms 2 Shadow Rep', 'software_engineer_count': 1352, 'percentage_share': 17.055632647912198}, {'division': 'Commercial Platforms', 'software_engineer_count': 1251, 'percentage_share': 15.781506244480887}]","WITH SoftwareEngineers AS ( SELECT division, COUNT(*) AS num_engineers FROM people WHERE job_family LIKE '%Software Engineering%' GROUP BY division ), RankedSoftwareEngineers AS ( SELECT se.division, se.num_engineers, RANK() OVER (ORDER BY se.num_engineers DESC) AS rank, (se.num_engineers * 100.0 / (SELECT SUM(num_engineers) FROM SoftwareEngineers)) AS percentage FROM SoftwareEngineers se ) SELECT rse.division, rse.num_engineers, rse.percentage FROM RankedSoftwareEngineers rse WHERE rse.rank <= 3 ORDER BY rse.num_engineers DESC, rse.division;","[{'division': 'Retail Platforms', 'num_engineers': 2174, 'percentage': 27.4252554560363315}, {'division': 'Platforms 2 Shadow Rep', 'num_engineers': 1352, 'percentage': 17.0556326479121988}, {'division': 'Commercial Platforms', 'num_engineers': 1251, 'percentage': 15.7815062444808881}]",,
16,extra,DAAI - Linda,"people, holiday_details","Christmas� day needs to be booked off, what percentage of staff working in Chief security office division have done this?",SELECT (SELECT COUNT(DISTINCT people.resource_id) FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE holiday_details.date = '2024-12-25' AND people.division LIKE '%Chief Security Office%') * 100.0 / (SELECT COUNT(*) FROM people WHERE people.division LIKE '%Chief Security Office%') AS percentage_on_christmas;,SELECT (SELECT COUNT(DISTINCT people.resource_id) FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE holiday_details.date = '2024-12-25' AND people.division LIKE '%Chief Security Office%') * 100.0 / (SELECT COUNT(*) FROM people WHERE people.division LIKE '%Chief Security Office%') AS percentage_on_christmas;,[{'percentage_on_christmas': 14.549180327868852}],"SELECT CAST(COUNT(DISTINCT CASE WHEN hd.date = '2024-12-25' THEN hd.colleague_id ELSE NULL END) AS REAL) * 100 / COUNT(DISTINCT p.resource_id) FROM people AS p LEFT JOIN (SELECT hd.*, ROW_NUMBER() OVER (PARTITION BY colleague_id ORDER BY entered_on DESC) as rn FROM holiday_details hd WHERE date = '2024-12-25') AS hd ON p.resource_id = hd.colleague_id AND hd.rn = 1 WHERE p.division ILIKE '%Chief Security Office%';","[{""?column?"": 14.549180327868852}]",,
17,easy,DAAI - Matt,people,How many times is Daniel Juarez listed in layer_2?   ,SELECT COUNT(*) FROM people WHERE layer_2 ='Daniel Juarez',SELECT COUNT(*) FROM people WHERE layer_2 = 'Daniel Juarez';,[{'count': 24649}],SELECT COUNT(*) FROM people WHERE layer_2 ILIKE '%Daniel Juarez%';,[{'count': 24649}],,
18,medium,DAAI - Matt,people,Which employee has the longest tenure? ,SELECT full_name FROM people WHERE original_tenure_start IS NOT null ORDER BY original_tenure_start ASC LIMIT 1;,SELECT full_name FROM people WHERE original_tenure_start IS NOT NULL ORDER BY original_tenure_start ASC LIMIT 1;,[{'full_name': 'Richard Moody'}],SELECT full_name FROM people WHERE original_tenure_start IS NOT NULL AND leave_date IS NULL ORDER BY original_tenure_start ASC;,Gave all names,,
19,easy,DAAI - Matt,people,I need the email address of Nathaniel Harris line manager? ,SELECT line_manager_email  FROM people WHERE full_name = 'Nathaniel Harris' ,SELECT line_manager_email FROM people WHERE full_name = 'Nathaniel Harris';,[{'line_manager_email': 'amanda.lane@BankA.com'}],SELECT line_manager_email FROM people WHERE full_name ILIKE '%Nathaniel Harris%';,[{'line_manager_email': 'amanda.lane@BankA.com'}],,
20,easy,DAAI - Matt,people,What is the average full-time equivilant (FTE) across all employees based on 1 being eveyone is full time? ,SELECT AVG(people.fte) FROM people;,SELECT AVG(fte) FROM people;,[{'avg': 0.9920763167382387}],SELECT AVG(fte) FROM people;,[{'avg': 0.9920763167382387}],,
21,easy,DAAI - Matt,people,I want to know how many colleague email address domains are different to their line manager domains? ,"SELECT COUNT(*) AS DifferentDomainCount FROM people WHERE SUBSTR(email, INSTR(email, '@') + 1) != SUBSTR(line_manager_email, INSTR(line_manager_email, '@') + 1)",SELECT COUNT(*) AS DifferentDomainCount FROM people WHERE SUBSTRING(email FROM POSITION('@' IN email) + 1) != SUBSTRING(line_manager_email FROM POSITION('@' IN line_manager_email) + 1);,[{'differentdomaincount': 23687}],SELECT COUNT(DISTINCT resource_id) FROM people WHERE email IS NOT NULL AND line_manager_email IS NOT NULL AND substring(email FROM '@(.*)$') NOT ILIKE substring(line_manager_email FROM '@(.*)$');,[{'count': 23687}],,
22,medium,DAAI - Tai ,"Holiday details, PEOPLE",Whats the average time between the the entered holiday date and the actual holiday date for employees grade C? Please round to 2 decimal places.,"SELECT round(avg(JULIANDAY(date) - JULIANDAY(entered_on)), 2) AS AVG_DIFF FROM people A  JOIN holiday_details B ON A.resource_id = B.colleague_id WHERE grade = 'C';","SELECT ROUND(AVG(EXTRACT(EPOCH FROM (date - entered_on)) / 86400), 2) AS AVG_DIFF FROM people A JOIN holiday_details B ON A.resource_id = B.colleague_id WHERE grade = 'C';",Error: 500,�,,,
23,medium,DAAI - Tai ,"ART_data, PEOPLE",Can you provide the job title and grades of the top 5 employees with the highest accured holiday hours? ,"SELECT people.job_title, people.grade FROM holiday_balance JOIN people ON holiday_balance.colleague_id = PEOPLE.resource_id ORDER BY holiday_balance.accrued DESC LIMIT 5;","SELECT people.job_title, people.grade FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id ORDER BY holiday_balance.accrued DESC LIMIT 5;","[{'job_title': 'Manager', 'grade': 'E'}, {'job_title': 'Data Engineering Manager', 'grade': 'E'}, {'job_title': 'Industrial Placement Software Engineering B', 'grade': 'B'}, {'job_title': 'Quality Engineer', 'grade': 'E'}, {'job_title': 'Senior Cyber Threat Operations Analyst', 'grade': 'D'}]","SELECT p.job_title, p.grade FROM people p JOIN holiday_balance hb ON p.resource_id = hb.colleague_id WHERE hb.report_date = (SELECT MAX(report_date) FROM holiday_balance) ORDER BY hb.accrued DESC LIMIT 5;","[{'job_title': 'Manager', 'grade': 'E'}, {'job_title': 'Data Engineering Manager', 'grade': 'E'}, {'job_title': 'Industrial Placement Software Engineering B', 'grade': 'B'}, {'job_title': 'Quality Engineer', 'grade': 'E'}, {'job_title': 'Senior Cyber Threat Operations Analyst', 'grade': 'D'}]",,
24,hard,DAAI - Tai ,PEOPLE,"On average, how many people are managed by grade F managers?","SELECT AVG (count_manager_ids) FROM (SELECT COUNT (*) AS count_manager_ids, direct_line_manager_id FROM people WHERE direct_line_manager_id IN (SELECT resource_id FROM people WHERE grade = 'F') GROUP BY 2);","SELECT AVG(count_manager_ids) FROM (SELECT COUNT(*) AS count_manager_ids, direct_line_manager_id FROM people WHERE direct_line_manager_id IN (SELECT resource_id FROM people WHERE grade = 'F') GROUP BY direct_line_manager_id) AS subquery;",[{'avg': 9.898016997167138}],SELECT CASE WHEN COUNT(DISTINCT direct_line_manager_id) = 0 THEN 0 ELSE CAST(COUNT(resource_id) AS REAL) / COUNT(DISTINCT direct_line_manager_id) END FROM people WHERE grade = 'F';,[{'case': 2.0610211706102115}],,
25,medium,DAAI - Tai ,"PEOPLE, Holiday_balance",Can you provide the date Robert Benson's most recent leave? ,SELECT MAX(DATE) from people A  JOIN holiday_details B  ON A.resource_id = B.colleague_id  WHERE full_name  LIKE '%Robert Benson%' AND taken_tf = 1;,SELECT MAX(DATE) FROM people A JOIN holiday_details B ON A.resource_id = B.colleague_id WHERE full_name LIKE '%Robert Benson%' AND taken_tf = 1;,Error: 500,,,,
26,medium,DAAI - Tai ,PEOPLE,Name of the colleagues scheduled to work the most hours? ,SELECT full_name FROM people WHERE scheduled_working_hours = (select MAX(scheduled_working_hours) FROM people);,SELECT full_name FROM people WHERE scheduled_working_hours = (SELECT MAX(scheduled_working_hours) FROM people);,[{'full_name': 'Derrick Sparks'}],SELECT full_name FROM people WHERE scheduled_working_hours = (SELECT MAX(scheduled_working_hours) FROM people);,[{'full_name': 'Derrick Sparks'}],,
27,medium,DAAI - Rita,"people, Holiday_balance",I'm Philip Young. What is the total amount of holiday not booked by my direct team?,SELECT SUM(unbooked) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id  WHERE direct_line_manager_name = 'Philip Young';,SELECT SUM(unbooked) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE direct_line_manager_name = 'Philip Young';,[{'sum': 561.25}],SELECT SUM(hb.unbooked) FROM people AS p JOIN holiday_balance AS hb ON p.resource_id = hb.colleague_id WHERE p.direct_line_manager_name ILIKE 'Philip Young%';,[{'sum': 561.25}],,
28,medium,DAAI - Rita,"people, Holiday_balance",I'm Philip Young. What is the total amount of holiday still needed to be booked by my direct team?,SELECT SUM(unbooked) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id  WHERE direct_line_manager_name = 'Philip Young';,SELECT SUM(unbooked) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE direct_line_manager_name = 'Philip Young';,[{'sum': 561.25}],SELECT SUM(hb.unbooked) FROM people AS p JOIN holiday_balance AS hb ON p.resource_id = hb.colleague_id WHERE p.direct_line_manager_name ILIKE 'Philip Young' AND hb.report_date = (SELECT MAX(report_date) FROM holiday_balance);,[{'sum': 561.25}],,
29,medium,DAAI - Rita,"people, Holiday_balance",My file id is 00069268. What is the total amount of holiday not booked by my direct team?,SELECT SUM(unbooked) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id  WHERE direct_line_manager_id = '00069268';,SELECT SUM(unbooked) FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE direct_line_manager_id = '00069268';,[{'sum': 561.25}],SELECT SUM(hb.unbooked) FROM people AS p JOIN holiday_balance AS hb ON p.resource_id = hb.colleague_id WHERE p.direct_line_manager_id LIKE '%00069268%' AND hb.report_date = (SELECT MAX(report_date) FROM holiday_balance);,[{'sum': 561.25}],,
30,medium,DAAI - Rita,people,"How many senior colleagues are in CDAO (cc_layer_2)? Senior colleagues are grades F, G and X","SELECT COUNT(*) FROM people  WHERE cc_layer_2 LIKE '%CDAO%' AND grade IN ('F', 'G', 'X');","SELECT COUNT(*) FROM people WHERE cc_layer_2 LIKE '%CDAO%' AND grade IN ('F', 'G', 'X');",[{'count': 105}],"SELECT COUNT(DISTINCT resource_id) FROM people WHERE cc_layer_2 ILIKE '%CDAO%' AND grade IN ('F', 'G', 'X');",[{'count': 105}],,
31,medium,DAAI - Rita,people,How many F+ colleagues are in CDAO (cc_layer_2)? Exclude MT grade,SELECT COUNT(*) FROM people  WHERE cc_layer_2 LIKE '%CDAO%' AND grade >= 'F' AND grade <> 'MT';,SELECT COUNT(*) FROM people WHERE cc_layer_2 LIKE '%CDAO%' AND grade >= 'F' AND grade <> 'MT';,[{'count': 106}],SELECT COUNT(*) FROM people WHERE division ILIKE '%Chief Data & Analytics Office%' AND grade >= 'F' AND UPPER(grade) != 'MT';,[{'count': 68}],,
32,hard,DAAI - Rita,"people, art",I'm Kimberly Mcclure. How many colleagues by grade have yet to complete ART this quarter (Q3 2024 - ART) in my overall team (layer_5)?,"SELECT grade, COUNT(DISTINCT a.resource_id) FROM art AS a JOIN people AS p ON a.resource_id =  p.resource_id WHERE layer_5= 'Kimberly Mcclure' AND compliance_program = 'Q3 2024 - ART'  AND final_art_status IN ('In progress', 'Not started') GROUP BY grade;","SELECT grade, COUNT(DISTINCT a.resource_id) FROM art AS a JOIN people AS p ON a.resource_id = p.resource_id WHERE layer_5 = 'Kimberly Mcclure' AND compliance_program = 'Q3 2024 - ART' AND final_art_status IN ('In progress', 'Not started') GROUP BY grade;","[{'grade': 'A', 'count': 1}, {'grade': 'B', 'count': 1}, {'grade': 'C', 'count': 6}, {'grade': 'D', 'count': 9}, {'grade': 'E', 'count': 25}, {'grade': 'F', 'count': 5}, {'grade': 'U', 'count': 4}, {'grade': 'X', 'count': 1}]","SELECT p.grade, COUNT(DISTINCT p.resource_id) FROM people AS p JOIN art AS a ON p.resource_id = a.resource_id WHERE p.layer_5_file_id = (SELECT resource_id FROM people WHERE full_name ILIKE '%Kimberly Mcclure%') AND a.compliance_program ILIKE '%Q3 2024 - ART%' AND a.final_art_status NOT ILIKE '%Completed%' AND a.final_art_status NOT ILIKE '%Completed late%' GROUP BY p.grade;","[{'grade': 'A', 'count': 1}, {'grade': 'B', 'count': 1}, {'grade': 'C', 'count': 6}, {'grade': 'D', 'count': 9}, {'grade': 'E', 'count': 25}, {'grade': 'F', 'count': 5}, {'grade': 'U', 'count': 4}, {'grade': 'X', 'count': 1}]",,
33,hard,DAAI - Rita,"people, art",I'm Kimberly Mcclure. How many colleagues by grade have yet to complete Q3 2024 - ART in my team (layer_5)?,"SELECT grade, COUNT(DISTINCT a.resource_id) FROM art AS a JOIN people AS p ON a.resource_id =  p.resource_id WHERE layer_5= 'Kimberly Mcclure' AND compliance_program = 'Q3 2024 - ART'  AND final_art_status IN ('In progress', 'Not started') GROUP BY grade;","SELECT grade, COUNT(DISTINCT a.resource_id) FROM art AS a JOIN people AS p ON a.resource_id = p.resource_id WHERE layer_5 = 'Kimberly Mcclure' AND compliance_program = 'Q3 2024 - ART' AND final_art_status IN ('In progress', 'Not started') GROUP BY grade;","[{'grade': 'A', 'count': 1}, {'grade': 'B', 'count': 1}, {'grade': 'C', 'count': 6}, {'grade': 'D', 'count': 9}, {'grade': 'E', 'count': 25}, {'grade': 'F', 'count': 5}, {'grade': 'U', 'count': 4}, {'grade': 'X', 'count': 1}]","SELECT COUNT(DISTINCT T1.resource_id), T1.grade FROM people AS T1 INNER JOIN art AS T2 ON T1.resource_id = T2.resource_id WHERE T1.layer_5_file_id = ( SELECT resource_id FROM people WHERE full_name ILIKE '%Kimberly Mcclure%' ) AND T2.compliance_program ILIKE '%Q3 2024 - ART%' AND NOT T2.final_art_status ILIKE '%Completed%' GROUP BY T1.grade;","[{'grade': 'A', 'count': 1}, {'grade': 'B', 'count': 1}, {'grade': 'C', 'count': 6}, {'grade': 'D', 'count': 9}, {'grade': 'E', 'count': 25}, {'grade': 'F', 'count': 5}, {'grade': 'U', 'count': 4}, {'grade': 'X', 'count': 1}]",,
34,hard,DAAI - Rita,"people, art",I'm Kimberly Mcclure. How many colleagues by grade have yet to complete Q3 2024 - ART in my team (layer_5)? Use DISTINCT id,"SELECT grade, COUNT(DISTINCT a.resource_id) FROM art AS a JOIN people AS p ON a.resource_id =  p.resource_id WHERE layer_5= 'Kimberly Mcclure' AND compliance_program = 'Q3 2024 - ART'  AND final_art_status IN ('In progress', 'Not started') GROUP BY grade;","SELECT grade, COUNT(DISTINCT a.resource_id) FROM art AS a JOIN people AS p ON a.resource_id = p.resource_id WHERE layer_5 = 'Kimberly Mcclure' AND compliance_program = 'Q3 2024 - ART' AND final_art_status IN ('In progress', 'Not started') GROUP BY grade;","[{'grade': 'A', 'count': 1}, {'grade': 'B', 'count': 1}, {'grade': 'C', 'count': 6}, {'grade': 'D', 'count': 9}, {'grade': 'E', 'count': 25}, {'grade': 'F', 'count': 5}, {'grade': 'U', 'count': 4}, {'grade': 'X', 'count': 1}]","SELECT p.grade, COUNT(DISTINCT p.resource_id) FROM people AS p JOIN art AS a ON p.resource_id = a.resource_id WHERE a.compliance_program LIKE 'Q3 2024 - ART' AND a.final_art_status != 'Completed' AND p.layer_5_file_id = (SELECT resource_id FROM people WHERE full_name LIKE 'Kimberly Mcclure') GROUP BY p.grade;","[{'grade': 'A', 'count': 1}, {'grade': 'B', 'count': 1}, {'grade': 'C', 'count': 6}, {'grade': 'D', 'count': 9}, {'grade': 'E', 'count': 25}, {'grade': 'F', 'count': 5}, {'grade': 'U', 'count': 4}, {'grade': 'X', 'count': 1}]",,
35,hard,DAAI - Rita,"people, Holiday_balance",My file id is 00069268  (layer_6). What is the amount of holiday still to take for each colleague (resource_id) in my team ordered by biggest first,"SELECT resource_id, untaken FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id  WHERE layer_6_file_id = '00069268' ORDER BY 2 DESC;","SELECT resource_id, untaken FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE layer_6_file_id = '00069268' ORDER BY untaken DESC;","[{'resource_id': '00033335', 'untaken': 257.251183}, {'resource_id': '00069268', 'untaken': 203.0}, {'resource_id': '00005127', 'untaken': 202.0}, {'resource_id': '00075927', 'untaken': 183.0}, {'resource_id': '42972402', 'untaken': 182.5}, {'resource_id': '00069498', 'untaken': 176.0}, {'resource_id': '00034885', 'untaken': 154.0}, {'resource_id': '00009049', 'untaken': 154.0}, {'resource_id': '66485900', 'untaken': 146.943548}, {'resource_id': '00983477', 'untaken': 126.0}, {'resource_id': '00789229', 'untaken': 122.75}]",�,"[{'resource_id': '00033335', 'untaken': 257.251183}, {'resource_id': '00069268', 'untaken': 203.0}, {'resource_id': '00005127', 'untaken': 202.0}, {'resource_id': '00075927', 'untaken': 183.0}, {'resource_id': '42972402', 'untaken': 182.5}, {'resource_id': '00069498', 'untaken': 176.0}, {'resource_id': '00034885', 'untaken': 154.0}, {'resource_id': '00009049', 'untaken': 154.0}, {'resource_id': '66485900', 'untaken': 146.943548}, {'resource_id': '00983477', 'untaken': 126.0}, {'resource_id': '00789229', 'untaken': 122.75}]",,
36,hard,DAAI - Rita,"people, Holiday_balance",My file id is 00069268  (layer_6_file_id). What is the amount of holiday still to take for each colleague  (resource_id)  in my team ordered by biggest first,"SELECT resource_id, untaken FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id  WHERE layer_6_file_id = '00069268' ORDER BY 2 DESC;","SELECT resource_id, untaken FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE layer_6_file_id = '00069268' ORDER BY untaken DESC;","[{'resource_id': '00033335', 'untaken': 257.251183}, {'resource_id': '00069268', 'untaken': 203.0}, {'resource_id': '00005127', 'untaken': 202.0}, {'resource_id': '00075927', 'untaken': 183.0}, {'resource_id': '42972402', 'untaken': 182.5}, {'resource_id': '00069498', 'untaken': 176.0}, {'resource_id': '00034885', 'untaken': 154.0}, {'resource_id': '00009049', 'untaken': 154.0}, {'resource_id': '66485900', 'untaken': 146.943548}, {'resource_id': '00983477', 'untaken': 126.0}, {'resource_id': '00789229', 'untaken': 122.75}]",�,,,
37,hard,DAAI - Rita,"people, Holiday_balance",My file id is 00069268  (layer_6). What is the amount of holiday not taken for each colleague in my team ordered by biggest first. Give the name and email,"SELECT full_name, email, untaken FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id  WHERE layer_6_file_id = '00069268' ORDER BY 3 DESC;","SELECT full_name, email, untaken FROM holiday_balance JOIN people ON holiday_balance.colleague_id = people.resource_id WHERE layer_6_file_id = '00069268' ORDER BY untaken DESC;","[{'full_name': 'Jillian Stokes', 'email': 'jillian.stokes@BankB.com', 'untaken': 257.251183}, {'full_name': 'Philip Young', 'email': 'philip.young@BankA.com', 'untaken': 203.0}, {'full_name': 'Alex Johnson', 'email': 'gregory.roy@BankA.com', 'untaken': 202.0}, {'full_name': 'Jennifer Coleman', 'email': 'jennifer.coleman@BankD.com', 'untaken': 183.0}, {'full_name': 'Janet Welch', 'email': 'janet.welch@BankA.com', 'untaken': 182.5}, {'full_name': 'David Cordova', 'email': 'david.cordova@BankC.com', 'untaken': 176.0}, {'full_name': 'Regina Wilson', 'email': 'ashley.washington@BankB.com', 'untaken': 154.0}, {'full_name': 'Joan Bennett', 'email': 'joan.bennett@BankA.com', 'untaken': 154.0}, {'full_name': 'Jennifer Blankenship', 'email': 'jennifer.blankenship@BankC.com', 'untaken': 146.943548}, {'full_name': 'Summer Schultz', 'email': 'summer.schultz@BankD.com', 'untaken': 126.0}, {'full_name': 'Jason Perez', 'email': 'jason.perez@BankC.com', 'untaken': 122.75}]","SELECT p.full_name, p.email, hb.untaken FROM people p INNER JOIN ( SELECT colleague_id, untaken, ROW_NUMBER() OVER (PARTITION BY colleague_id ORDER BY report_date DESC) as rn FROM holiday_balance ) hb ON p.resource_id = hb.colleague_id WHERE p.layer_6_file_id = '00069268' AND hb.untaken > 0 AND hb.rn = 1 ORDER BY hb.untaken DESC;","[{'full_name': 'Jillian Stokes', 'email': 'jillian.stokes@BankB.com', 'untaken': 257.251183}, {'full_name': 'Philip Young', 'email': 'philip.young@BankA.com', 'untaken': 203.0}, {'full_name': 'Alex Johnson', 'email': 'gregory.roy@BankA.com', 'untaken': 202.0}, {'full_name': 'Jennifer Coleman', 'email': 'jennifer.coleman@BankD.com', 'untaken': 183.0}, {'full_name': 'Janet Welch', 'email': 'janet.welch@BankA.com', 'untaken': 182.5}, {'full_name': 'David Cordova', 'email': 'david.cordova@BankC.com', 'untaken': 176.0}, {'full_name': 'Regina Wilson', 'email': 'ashley.washington@BankB.com', 'untaken': 154.0}, {'full_name': 'Joan Bennett', 'email': 'joan.bennett@BankA.com', 'untaken': 154.0}, {'full_name': 'Jennifer Blankenship', 'email': 'jennifer.blankenship@BankC.com', 'untaken': 146.943548}, {'full_name': 'Summer Schultz', 'email': 'summer.schultz@BankD.com', 'untaken': 126.0}, {'full_name': 'Jason Perez', 'email': 'jason.perez@BankC.com', 'untaken': 122.75}]",,
38,hard,DAAI - Rita,people,My file id is 00067222. What is the percentage of non perm workers in my direct team?,SELECT (SUM(CASE WHEN high_lev_workertype <> 'Permanent' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) FROM people WHERE direct_line_manager_id = '00067222';,SELECT (SUM(CASE WHEN high_lev_workertype <> 'Permanent' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) FROM people WHERE direct_line_manager_id = '00067222';,[{'?column?': 50.0}],�,,,
39,hard,DAAI - Rita,people,My file id is 00067222. Can you please tell me the percentage of non permanent workers in my team?,SELECT (SUM(CASE WHEN high_lev_workertype <> 'Permanent' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) FROM people WHERE direct_line_manager_id = '00067222';,SELECT (SUM(CASE WHEN high_lev_workertype <> 'Permanent' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) FROM people WHERE direct_line_manager_id = '00067222';,[{'?column?': 50.0}],SELECT CAST(SUM(CASE WHEN worker_type != '1. Permanent Colleague' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(*) FROM people WHERE direct_line_manager_id = (SELECT direct_line_manager_id FROM people WHERE resource_id = '00067222');,[{'?column?': 45.45454545454545}],,
40,hard,DAAI - Rita,"people, Holiday_details",My file id is 00069268  (layer_6_file_id). Who in my team has booked the new year's bank holiday? Want the id and name,"SELECT colleague_id, full_name FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE layer_6_file_id = '00069268' AND DATE = '2024-01-01' GROUP BY colleague_id HAVING SUM(hours) > 1","SELECT colleague_id, full_name FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE layer_6_file_id = '00069268' AND DATE = '2024-01-01' GROUP BY colleague_id HAVING SUM(hours) > 1;",Error: 500,,,,
41,hard,DAAI - Rita,"people, Holiday_details",My file id is 00069268  (layer_6_file_id). Who in my team has booked holiday for January first of this year? Want the id and name,"SELECT colleague_id, full_name FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE layer_6_file_id = '00069268' AND DATE = '2024-01-01' GROUP BY colleague_id HAVING SUM(hours) > 1","SELECT colleague_id, full_name FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE layer_6_file_id = '00069268' AND DATE = '2024-01-01' GROUP BY colleague_id HAVING SUM(hours) > 1;",Error: 500,"SELECT p.resource_id, p.full_name FROM people AS p WHERE p.layer_6_file_id = '00069268' AND NOT EXISTS (SELECT 1 FROM holiday_details AS hd WHERE hd.colleague_id = p.resource_id AND hd.date = '2024-01-01');","[{'resource_id': '00005127', 'full_name': 'Alex Johnson'}, {'resource_id': '42972402', 'full_name': 'Janet Welch'}, {'resource_id': '00075927', 'full_name': 'Jennifer Coleman'}, {'resource_id': '49672490', 'full_name': 'Rebecca Pierce'}]",,
42,extra,DAAI - Rita,"people, Holiday_details",My file id is 00069268  (layer_6_file_id). Who in my team has not booked holiday for January first of this year? Want the id and name,"WITH colleagues_with_booked_date AS ( SELECT colleague_id  FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE layer_6_file_id = '00069268' AND DATE = '2024-01-01' GROUP BY colleague_id HAVING SUM(hours) > 1 ) SELECT resource_id, full_name FROM people p LEFT JOIN colleagues_with_booked_date c ON p.resource_id = c.colleague_id WHERE layer_6_file_id = '00069268' AND c.colleague_id IS NULL;","WITH colleagues_with_booked_date AS (SELECT colleague_id FROM people JOIN holiday_details ON people.resource_id = holiday_details.colleague_id WHERE layer_6_file_id = '00069268' AND DATE = '2024-01-01' GROUP BY colleague_id HAVING SUM(hours) > 1) SELECT resource_id, full_name FROM people p LEFT JOIN colleagues_with_booked_date c ON p.resource_id = c.colleague_id WHERE layer_6_file_id = '00069268' AND c.colleague_id IS NULL;","[{'resource_id': '00005127', 'full_name': 'Alex Johnson'}, {'resource_id': '42972402', 'full_name': 'Janet Welch'}, {'resource_id': '00075927', 'full_name': 'Jennifer Coleman'}, {'resource_id': '49672490', 'full_name': 'Rebecca Pierce'}]",Duplicate Question,,,
43,medium,DAAI - Rita,"people, Holiday_balance",What colleagues in CDAO (cc_layer_2) have more than 80% of their holidays left unbooked?,SELECT full_name FROM holiday_balance JOIN people ON people.resource_id = holiday_balance.colleague_id WHERE unbooked > 0.8*entitlement AND cc_layer_2 LIKE '%CDAO%';,SELECT full_name FROM holiday_balance JOIN people ON people.resource_id = holiday_balance.colleague_id WHERE unbooked > 0.8 * entitlement AND cc_layer_2 LIKE '%CDAO%';,"[{'full_name': 'Monica Smith'}, {'full_name': 'Jessica Ward'}, {'full_name': 'Meghan Smith'}, {'full_name': 'Roberto Grant'}, {'full_name': 'Jennifer Strong'}, {'full_name': 'Peter Torres'}, {'full_name': 'Kenneth Lewis'}, {'full_name': 'Rebecca Riddle'}, {'full_name': 'Danielle Cummings'}, {'full_name': 'Cassandra Anderson'}, {'full_name': 'Edgar Simmons'}, {'full_name': 'William Holt'}, {'full_name': 'Annette Robinson'}, {'full_name': 'Thomas Henry'}, {'full_name': 'Susan Walton'}, {'full_name': 'Andrew Zimmerman'}, {'full_name': 'Donna Valencia'}, {'full_name': 'Kyle Anthony'}, {'full_name': 'David Hunter'}, {'full_name': 'Lee Bruce'}, {'full_name': 'Walter Robinson'}, {'full_name': 'Scott Gomez'}, {'full_name': 'Ashley Pierce'}, {'full_name': 'Craig Barnes'}, {'full_name': 'Bethany Gould'}, {'full_name': 'Sara Alvarado'}, {'full_name': 'Andrew Eaton'}]",Duplicate Question,,,
44,medium,DAAI - Rita,"people, Holiday_balance",What colleagues in CDAO (cc_layer_2) have more than 80% of holiday entitlement left to book? Give their name,SELECT full_name FROM holiday_balance JOIN people ON people.resource_id = holiday_balance.colleague_id WHERE unbooked > 0.8*entitlement AND cc_layer_2 LIKE '%CDAO%';,SELECT full_name FROM holiday_balance JOIN people ON people.resource_id = holiday_balance.colleague_id WHERE unbooked > 0.8 * entitlement AND cc_layer_2 LIKE '%CDAO%';,"[{'full_name': 'Monica Smith'}, {'full_name': 'Jessica Ward'}, {'full_name': 'Meghan Smith'}, {'full_name': 'Roberto Grant'}, {'full_name': 'Jennifer Strong'}, {'full_name': 'Peter Torres'}, {'full_name': 'Kenneth Lewis'}, {'full_name': 'Rebecca Riddle'}, {'full_name': 'Danielle Cummings'}, {'full_name': 'Cassandra Anderson'}, {'full_name': 'Edgar Simmons'}, {'full_name': 'William Holt'}, {'full_name': 'Annette Robinson'}, {'full_name': 'Thomas Henry'}, {'full_name': 'Susan Walton'}, {'full_name': 'Andrew Zimmerman'}, {'full_name': 'Donna Valencia'}, {'full_name': 'Kyle Anthony'}, {'full_name': 'David Hunter'}, {'full_name': 'Lee Bruce'}, {'full_name': 'Walter Robinson'}, {'full_name': 'Scott Gomez'}, {'full_name': 'Ashley Pierce'}, {'full_name': 'Craig Barnes'}, {'full_name': 'Bethany Gould'}, {'full_name': 'Sara Alvarado'}, {'full_name': 'Andrew Eaton'}]",SELECT p.full_name FROM people AS p JOIN holiday_balance AS hb ON p.resource_id = hb.colleague_id WHERE p.cc_layer_2 LIKE '%CDAO%' AND hb.unbooked >= 0.8 * hb.entitlement;,"[{'full_name': 'Monica Smith'}, {'full_name': 'Jessica Ward'}, {'full_name': 'Meghan Smith'}, {'full_name': 'Roberto Grant'}, {'full_name': 'Jennifer Strong'}, {'full_name': 'Peter Torres'}, {'full_name': 'Kenneth Lewis'}, {'full_name': 'Rebecca Riddle'}, {'full_name': 'Danielle Cummings'}, {'full_name': 'Cassandra Anderson'}, {'full_name': 'Edgar Simmons'}, {'full_name': 'William Holt'}, {'full_name': 'Annette Robinson'}, {'full_name': 'Thomas Henry'}, {'full_name': 'Susan Walton'}, {'full_name': 'Andrew Zimmerman'}, {'full_name': 'Donna Valencia'}, {'full_name': 'Kyle Anthony'}, {'full_name': 'David Hunter'}, {'full_name': 'Lee Bruce'}, {'full_name': 'Walter Robinson'}, {'full_name': 'Scott Gomez'}, {'full_name': 'Ashley Pierce'}, {'full_name': 'Craig Barnes'}, {'full_name': 'Bethany Gould'}, {'full_name': 'Sara Alvarado'}, {'full_name': 'Andrew Eaton'}]",,
 
